# Simple UI Test Flow
#
# This test focuses ONLY on UI interactions.
# Server-side mutations are done via a separate Node.js script.
#
# How to run:
# 1. First, run the setup script:
#    cd /Users/mlustig/Development/personal/instantdb/sharing-instant/maestro
#    node scripts/setup-and-mutate.mjs setup
#
# 2. Then run this Maestro test:
#    maestro test flows/ui-only-test.yaml
#
# 3. After the test reaches "waiting for server mutation", run:
#    node scripts/setup-and-mutate.mjs mutate
#
# 4. The test will continue and take screenshots

appId: com.lustig.sharinginstant.Sharing-Instant-Examples
---

# Launch app fresh
- launchApp:
    clearState: true

# Wait for app to load
- extendedWaitUntil:
    visible: "Observable Model"
    timeout: 15000

# Navigate to Observable Model demo
- tapOn: "Observable Model"

# Wait for the demo view to load
- extendedWaitUntil:
    visible: "Add New Todo"
    timeout: 10000

# Wait for Test Todo A to appear (created by setup script)
- extendedWaitUntil:
    visible: "Test Todo A"
    timeout: 15000

# Take initial screenshot
- takeScreenshot: 01_initial_state

# Tap on Test Todo A to toggle it (local mutation)
- tapOn: "Test Todo A"

# Wait a moment
- extendedWaitUntil:
    visible: "Test Todo A"
    timeout: 2000

# Take screenshot after local toggle
- takeScreenshot: 02_after_local_toggle

# Now wait - the user should run the server mutation script
# This gives 30 seconds for the server mutation to be triggered
- extendedWaitUntil:
    visible: "THIS_TEXT_WILL_NEVER_APPEAR"
    timeout: 30000
    optional: true

# Take screenshot after waiting for server mutation
- takeScreenshot: 03_after_server_mutation_wait
