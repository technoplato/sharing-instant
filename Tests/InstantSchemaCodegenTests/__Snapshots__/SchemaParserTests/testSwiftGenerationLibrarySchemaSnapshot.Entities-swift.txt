/// ═══════════════════════════════════════════════════════════════════════════════
/// Entities.swift
/// Generated by InstantSchemaCodegen
/// ═══════════════════════════════════════════════════════════════════════════════
///
/// ⚠️  DO NOT EDIT - This file is generated from your InstantDB schema.
/// Any changes will be overwritten on the next codegen run.
///
/// ─────────────────────────────────────────────────────────────────────────────────
/// WHAT THIS FILE IS
/// ─────────────────────────────────────────────────────────────────────────────────
///
/// This file contains Swift structs for each entity in your InstantDB schema.
/// These structs conform to `EntityIdentifiable`, `Codable`, and `Sendable`,
/// making them ready for use with `@Shared` and `@SharedReader`.
/// Each entity has:
/// • An `id` field (auto-generated UUID by default)
/// • All fields from your schema with proper Swift types
/// • Optional link properties (populated when using `.with()` queries)
/// • A memberwise initializer with sensible defaults
///
/// ─────────────────────────────────────────────────────────────────────────────────
/// HOW TO USE
/// ─────────────────────────────────────────────────────────────────────────────────
///
/// Create entities using the generated initializers, then add them to
/// synced collections using `$collection.withLock { }`.
/// • Create: `let item = Member(...)`
/// • Add: `$items.withLock { $0.append(item) }`
/// • Update: `$items.withLock { $0[index].field = newValue }`
/// • Delete: `$items.withLock { $0.remove(id: item.id) }`
///
/// ─────────────────────────────────────────────────────────────────────────────────
/// QUICK START - Copy & Paste Example
/// ─────────────────────────────────────────────────────────────────────────────────

/* Copy-pasteable example:

import SwiftUI
import SharingInstant
import IdentifiedCollections

struct MemberListContentView: View {
  @Shared(Schema.members)
  private var items: IdentifiedArrayOf<Member> = []

  var body: some View {
    List {
      ForEach(items) { item in
        Text("\(item.id)")
      }
    }
  }

  private func addItem() {
    let item = Member(
      name: "Name value",
      email: "Email value",
      memberSince: Date().timeIntervalSince1970,
      isActive: false,
      currentBorrowCount: Date().timeIntervalSince1970
    )
    $items.withLock { $0.append(item) }
  }

  private func deleteItem(_ item: Member) {
    $items.withLock { $0.remove(id: item.id) }
  }
}
*/

///
/// ─────────────────────────────────────────────────────────────────────────────────
/// AVAILABLE IN THIS FILE
/// ─────────────────────────────────────────────────────────────────────────────────
///
/// Member {
///   id: String
///   name: String
///   email: String
///   memberSince: Date
///   isActive: Bool
///   phoneNumber: String?
///   currentBorrowCount: Double
///   preferences: AnyCodable?
///   favoriteAuthor: Author?  // Link (has: one)
///   genreInterests: [Genre]?  // Link (has: many)
///   borrowedBooks: [Book]?  // Link (has: many)
///   borrowHistory: [BorrowRecord]?  // Link (has: many)
/// }
///
/// Author {
///   id: String
///   name: String
///   bio: String?
///   birthYear: Double?
///   isActive: Bool
///   bookCount: Double
///   books: [Book]?  // Link (has: many)
///   fans: [Member]?  // Link (has: many)
/// }
///
/// Book {
///   id: String
///   title: String
///   isbn: String
///   publicationYear: Double
///   pageCount: Double?
///   description: String?
///   averageRating: Double?
///   availableCopies: Double
///   metadata: AnyCodable?
///   genres: [Genre]?  // Link (has: many)
///   currentBorrower: Member?  // Link (has: one)
///   author: Author?  // Link (has: one)
///   borrowHistory: [BorrowRecord]?  // Link (has: many)
/// }
///
/// Genre {
///   id: String
///   name: String
///   code: String
///   description: String?
///   bookCount: Double
///   books: [Book]?  // Link (has: many)
///   interestedMembers: [Member]?  // Link (has: many)
/// }
///
/// BorrowRecord {
///   id: String
///   borrowedAt: Date
///   dueAt: Date
///   returnedAt: Date?
///   lateFeeInCents: Double?
///   book: Book?  // Link (has: one)
///   member: Member?  // Link (has: one)
/// }
///

///
/// ═══════════════════════════════════════════════════════════════════════════════

import Foundation
import SharingInstant

/// A library member who can borrow books.
/// Members have a unique email address and can:
/// - Borrow multiple books at once
/// - Have a favorite author
/// - Express interest in multiple genres
/// @example
/// ```typescript
/// const member = {
/// id: "mem_123",
/// name: "Jane Doe",
/// email: "jane@example.com"
/// };
/// ```
public struct Member: EntityIdentifiable, Codable, Sendable {
  public static var namespace: String { "members" }
  
  // MARK: - Fields
  
  /// The unique identifier for this entity
  public var id: String
  public var name: String
  public var email: String
  public var memberSince: Date
  public var isActive: Bool
  public var phoneNumber: String?
  public var currentBorrowCount: Double
  public var preferences: AnyCodable?

  // MARK: - Links
  // Populated when queried with .with(...)

  /// Link to authors via 'memberFavoriteAuthor'
  /// - Note: Only populated when queried with `.with(\.favoriteAuthor)`
  public var favoriteAuthor: Author?

  /// Link to genres via 'memberGenreInterests'
  /// - Note: Only populated when queried with `.with(\.genreInterests)`
  public var genreInterests: [Genre]?

  /// Link to books via 'bookBorrower'
  /// - Note: Only populated when queried with `.with(\.borrowedBooks)`
  public var borrowedBooks: [Book]?

  /// Link to borrowRecords via 'borrowRecordMember'
  /// - Note: Only populated when queried with `.with(\.borrowHistory)`
  public var borrowHistory: [BorrowRecord]?


  // MARK: - Initializer

  public init(
    id: String = UUID().uuidString,
    name: String,
    email: String,
    memberSince: Date,
    isActive: Bool,
    phoneNumber: String? = nil,
    currentBorrowCount: Double,
    preferences: AnyCodable? = nil,
    favoriteAuthor: Author? = nil,
    genreInterests: [Genre]? = nil,
    borrowedBooks: [Book]? = nil,
    borrowHistory: [BorrowRecord]? = nil
  ) {
    self.id = id
    self.name = name
    self.email = email
    self.memberSince = memberSince
    self.isActive = isActive
    self.phoneNumber = phoneNumber
    self.currentBorrowCount = currentBorrowCount
    self.preferences = preferences
    self.favoriteAuthor = favoriteAuthor
    self.genreInterests = genreInterests
    self.borrowedBooks = borrowedBooks
    self.borrowHistory = borrowHistory
  }
}


/// An author who writes books.
/// Authors can write multiple books and have fans.
public struct Author: EntityIdentifiable, Codable, Sendable {
  public static var namespace: String { "authors" }
  
  // MARK: - Fields
  
  /// The unique identifier for this entity
  public var id: String
  public var name: String
  public var bio: String?
  public var birthYear: Double?
  public var isActive: Bool
  public var bookCount: Double

  // MARK: - Links
  // Populated when queried with .with(...)

  /// Link to books via 'authorBooks'
  /// - Note: Only populated when queried with `.with(\.books)`
  public var books: [Book]?

  /// Link to members via 'memberFavoriteAuthor'
  /// - Note: Only populated when queried with `.with(\.fans)`
  public var fans: [Member]?


  // MARK: - Initializer

  public init(
    id: String = UUID().uuidString,
    name: String,
    bio: String? = nil,
    birthYear: Double? = nil,
    isActive: Bool,
    bookCount: Double,
    books: [Book]? = nil,
    fans: [Member]? = nil
  ) {
    self.id = id
    self.name = name
    self.bio = bio
    self.birthYear = birthYear
    self.isActive = isActive
    self.bookCount = bookCount
    self.books = books
    self.fans = fans
  }
}


/// A book in the library catalog.
/// ## ISBN Format
/// We support both ISBN-10 and ISBN-13 formats.
/// Store without hyphens for consistency.
public struct Book: EntityIdentifiable, Codable, Sendable {
  public static var namespace: String { "books" }
  
  // MARK: - Fields
  
  /// The unique identifier for this entity
  public var id: String
  public var title: String
  public var isbn: String
  public var publicationYear: Double
  public var pageCount: Double?
  public var description: String?
  public var averageRating: Double?
  public var availableCopies: Double
  public var metadata: AnyCodable?

  // MARK: - Links
  // Populated when queried with .with(...)

  /// Link to genres via 'bookGenres'
  /// - Note: Only populated when queried with `.with(\.genres)`
  public var genres: [Genre]?

  /// Link to members via 'bookBorrower'
  /// - Note: Only populated when queried with `.with(\.currentBorrower)`
  public var currentBorrower: Member?

  /// Link to authors via 'authorBooks'
  /// - Note: Only populated when queried with `.with(\.author)`
  public var author: Author?

  /// Link to borrowRecords via 'borrowRecordBook'
  /// - Note: Only populated when queried with `.with(\.borrowHistory)`
  public var borrowHistory: [BorrowRecord]?


  // MARK: - Initializer

  public init(
    id: String = UUID().uuidString,
    title: String,
    isbn: String,
    publicationYear: Double,
    pageCount: Double? = nil,
    description: String? = nil,
    averageRating: Double? = nil,
    availableCopies: Double,
    metadata: AnyCodable? = nil,
    genres: [Genre]? = nil,
    currentBorrower: Member? = nil,
    author: Author? = nil,
    borrowHistory: [BorrowRecord]? = nil
  ) {
    self.id = id
    self.title = title
    self.isbn = isbn
    self.publicationYear = publicationYear
    self.pageCount = pageCount
    self.description = description
    self.averageRating = averageRating
    self.availableCopies = availableCopies
    self.metadata = metadata
    self.genres = genres
    self.currentBorrower = currentBorrower
    self.author = author
    self.borrowHistory = borrowHistory
  }
}


/// A book genre/category.
public struct Genre: EntityIdentifiable, Codable, Sendable {
  public static var namespace: String { "genres" }
  
  // MARK: - Fields
  
  /// The unique identifier for this entity
  public var id: String
  public var name: String
  public var code: String
  public var description: String?
  public var bookCount: Double

  // MARK: - Links
  // Populated when queried with .with(...)

  /// Link to books via 'bookGenres'
  /// - Note: Only populated when queried with `.with(\.books)`
  public var books: [Book]?

  /// Link to members via 'memberGenreInterests'
  /// - Note: Only populated when queried with `.with(\.interestedMembers)`
  public var interestedMembers: [Member]?


  // MARK: - Initializer

  public init(
    id: String = UUID().uuidString,
    name: String,
    code: String,
    description: String? = nil,
    bookCount: Double,
    books: [Book]? = nil,
    interestedMembers: [Member]? = nil
  ) {
    self.id = id
    self.name = name
    self.code = code
    self.description = description
    self.bookCount = bookCount
    self.books = books
    self.interestedMembers = interestedMembers
  }
}


/// A record of a book being borrowed.
public struct BorrowRecord: EntityIdentifiable, Codable, Sendable {
  public static var namespace: String { "borrowRecords" }
  
  // MARK: - Fields
  
  /// The unique identifier for this entity
  public var id: String
  public var borrowedAt: Date
  public var dueAt: Date
  public var returnedAt: Date?
  public var lateFeeInCents: Double?

  // MARK: - Links
  // Populated when queried with .with(...)

  /// Link to books via 'borrowRecordBook'
  /// - Note: Only populated when queried with `.with(\.book)`
  public var book: Book?

  /// Link to members via 'borrowRecordMember'
  /// - Note: Only populated when queried with `.with(\.member)`
  public var member: Member?


  // MARK: - Initializer

  public init(
    id: String = UUID().uuidString,
    borrowedAt: Date,
    dueAt: Date,
    returnedAt: Date? = nil,
    lateFeeInCents: Double? = nil,
    book: Book? = nil,
    member: Member? = nil
  ) {
    self.id = id
    self.borrowedAt = borrowedAt
    self.dueAt = dueAt
    self.returnedAt = returnedAt
    self.lateFeeInCents = lateFeeInCents
    self.book = book
    self.member = member
  }
}


